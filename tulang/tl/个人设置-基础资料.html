<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>个人设置-基础资料</title>
    <!-- bootstap -->
    <link rel="stylesheet" href="bootstrap-3.3.5/css/bootstrap.min.css">

    <!-- 字体图标 -->
    <link rel="stylesheet" href="fonts/css/font-awesome.min.css">

    <!-- linkcloud -->
    <!--<link rel="stylesheet" href="../css/demo.css">-->

    <!-- your css -->
    <!--<link rel="stylesheet" href="../css/customer.css">-->
    <link rel="stylesheet" href="css/all.css"/>


</head>
<body class="f-bg2">
<nav class="m-header navbar-fixed-top">
    <div class="g-container">
        <h1><a href="#"><img width="112" height="48" src="img/logo2.png" alt=""/></a><span class="sr-only">图狼网</span></h1>

        <ul class="nav-main">
            <li class="active"><a href="#">了解我们</a></li>
            <li><a href="#">设计机构</a></li>
            <li><a href="#">寻找任务</a></li>
            <li><a href="#">图狼达人</a></li>
        </ul>

        <ul class="nav2">
            <li class="item search">
                <div class="input">
                    <input type="text"/>
                </div>
            </li>
            <li class="item fb">
                <a class="button" href="javascript:;">发布任务</a>
            </li>
            <li class="item msg">
                <span class="dot"></span>
                <img src="img/icon-msg.png" alt=""/>
                <div class="msgList">
                    <div class="inner">
                        <div class="text-center f-mb20">
                            <div class="tabs">
                                <a class="active" href="javascript:;">私信</a>
                                <a href="javascript:;">通知</a>
                            </div>
                        </div>
                        <ul>
                            <li>
                                <div class="media">
                                    <div class="media-left">
                                        <img class="img-circle" width="50" height="50" src="" alt=""/>
                                    </div>
                                    <div class="media-body">
                                        <div class="media-heading">用户名<span class="pull-right">3月15日</span></div>
                                        <p class="text-overflow">省深圳市南山区留仙大道世外桃源创意园省深圳市南山区留仙大道世外桃源创意园</p>
                                    </div>
                                </div>
                            </li>
                            <li>
                                <div class="media">
                                    <div class="media-left">
                                        <img class="img-circle" width="50" height="50" src="" alt=""/>
                                    </div>
                                    <div class="media-body">
                                        <div class="media-heading">用户名<span class="pull-right">3月15日</span></div>
                                        <p class="text-overflow">省深圳市南山区留仙大道世外桃源创意园省深圳市南山区留仙大道世外桃源创意园</p>
                                    </div>
                                </div>
                            </li>
                            <li>
                                <div class="media">
                                    <div class="media-left">
                                        <img class="img-circle" width="50" height="50" src="" alt=""/>
                                    </div>
                                    <div class="media-body">
                                        <div class="media-heading">用户名<span class="pull-right">3月15日</span></div>
                                        <p class="text-overflow">省深圳市南山区留仙大道世外桃源创意园省深圳市南山区留仙大道世外桃源创意园</p>
                                    </div>
                                </div>
                            </li>
                        </ul>
                    </div>
                    <div class="more">
                        <img src="img/icon-settings.png" alt=""/>
                        <a class="pull-right" href="javascript:;">查看更多</a>
                    </div>
                </div>
            </li>
            <li class="item tx">
                <div class="pic">
                    <span class="u-icon u-icon-v2"></span>
                    <img class="img-circle" width="50" height="50" src="img/tx-default.png" alt=""/>
                </div>
                <ul class="subNav">
                    <li><a href="javascript:;">我的主页</a></li>
                    <li><a href="javascript:;">我的账簿</a></li>
                    <li><a href="javascript:;">账号设置</a></li>
                    <li><a href="javascript:;"><span style="color: #ff4e4e;">退出</span></a></li>
                </ul>
            </li>
        </ul>

    </div>
</nav>
<div class="m-headerSpace"></div>

<div class="container f-mb40">

    <div class="p-userSetting">
        <div class="p-box f-bg">
            <div class="p-box-hd">
                <div class="m-title">
                    <h2>用户设置</h2>
                </div>
                <ul class="u-nav clearfix">
                    <li class="active"><a href="">基本资料</a></li>
                    <li><a href="">账号和密码</a></li>
                    <li><a href="">绑定微信</a></li>
                    <li><a href="">消息和好友</a></li>
                    <li><a href="">认证信息</a></li>
                    <li class="last"><a href="">项目案例</a></li>
                </ul>
            </div>
            <div class="p-box-bd">



                <div class="form-box">
                    <form method="post" class="form-horizontal" id="f-form-userSetting-base">




                        <div class="form-group">
                            <label class="col-sm-2 control-label">头像</label>
                            <div class="col-sm-10">
                                <div>
                                    <img class="img-circle" width="120" height="120" src="" alt="120x120"/>
                                    <div id="j-prevImgBox"></div>
                                    <input id="j-fileImg" type="file" class="j-uploadtx"/>
                                </div>
                            </div>
                        </div>




                        <div class="form-group form-inline">
                            <label class="col-sm-2 control-label">认证信息</label>
                            <div class="col-sm-10">
                                <div class="f-mb10">
                                    <input type="text" class="form-control" value="文沛霖"/>　认证信息 <a href="#">去认证</a>
                                </div>
                                <div class="">
                                    <label class="radio-inline">
                                        <input type="radio" name="inlineRadioOptions" value="option1" checked> 展示认证
                                    </label>
                                    <label class="radio-inline">
                                        <input type="radio" name="inlineRadioOptions" value="option2"> 不展示认证
                                    </label>
                                     <span class="form-text">认证展示的用户将被推荐到达人区</span>
                                </div>
                            </div>
                        </div>

                        <div class="form-group form-inline">
                            <label class="col-sm-2 control-label">昵称</label>
                            <div class="col-sm-10">

                                <input name="nickName" type="text" class="form-control" value="文沛霖"/>

                            </div>
                        </div>


                        <div class="form-group">
                            <label class="col-sm-2 control-label">个人简介</label>
                            <div class="col-sm-10">
                                <div class="f-pr40">
                                    <textarea class="form-control" rows="3">天行健，君子当自强不息。地势坤，君子以厚德载物。</textarea>
                                </div>
                            </div>
                        </div>



                        <div class="form-group">
                            <label class="col-sm-2 control-label">我的标签</label>
                            <div class="col-sm-10 f-pt7">
                                <div class="f-mb20 j-tagBox" style="display: none"></div>
                                <div>
                                    <div class="input-group iptw">
                                        <input maxlength="20" type="text" class="form-control j-tagIpt" placeholder="20个字以内，最多可以添加5个标签">
                                      <span class="input-group-btn">
                                        <button class="btn btn-primary j-addTag" type="button">添加</button>
                                      </span>
                                    </div>
                                </div>
                            </div>
                        </div>



                        <div class="form-group">
                            <label class="col-sm-2 control-label">详细描述</label>
                            <div class="col-sm-10">
                                <div class="f-pr40">
                                    <textarea class="form-control" rows="5">深圳利好政策频出，房价直线飙升，有不少媒体解读认为，杠杆资金和“炒房客”趁机杀入市场，形成新一轮的房价推手。近日，《证券日报》记者赶赴深圳，对房地产市场进行了实地调查，发现购房主力依然是刚需人群。深圳利好政策频出，房价直线飙升，有不少媒体解读认为，杠杆资金和“炒房客”趁机　</textarea>
                                </div>
                            </div>
                        </div>


                        <div class="line"></div>

                        <div class="form-group">
                            <label class="col-sm-2 control-label">工作地</label>
                            <div class="col-sm-10">

                                <div class="f-mb20">
                                    <div class="input-group iptw">
                                        <input type="text" class="form-control j-placeIpt" placeholder="添加工作地">
                                      <span class="input-group-btn">
                                        <button class="btn btn-primary j-addPlace" type="button">添加</button>
                                      </span>
                                    </div>
                                </div>
                                <ul class="list-unstyled list-inline j-placeBox" style="display: none;"></ul>

                            </div>
                        </div>


                        <div class="line"></div>



                        <div class="form-group form-inline">
                            <label class="col-sm-2 control-label">职业经历</label>
                            <div class="col-sm-10">

                                <div class="f-mb20">
                                    <ul class="list-unstyled j-liveBox">
                                        <li class="f-mb10">
                                            <input name="lives[0][company]" type="text" class="form-control" placeholder="公司或组织名称"><input name="lives[0][job]" type="text" class="form-control" placeholder="你的职位（选填）">
                                        </li>
                                    </ul>
                                </div>
                                <div>
                                    <button type="button" class="btn btn-primary j-addLive">添加</button>
                                </div>

                            </div>
                        </div>




                        <div class="form-group form-inline">
                            <label class="col-sm-2 control-label">教育经历</label>
                            <div class="col-sm-10">

                                <div class="f-mb20">
                                    <ul class="list-unstyled j-teachBox">
                                        <li class="f-mb10">
                                            <input name="teach[0][school]" type="text" class="form-control" placeholder="学校或教育机构名称"><input name="teach[0][specialty]" type="text" class="form-control" placeholder="专业方向（选填）">
                                        </li>
                                    </ul>
                                </div>
                                <div>
                                    <button type="button" class="btn btn-primary j-addTeach">添加</button>
                                </div>

                            </div>
                        </div>



                        <div class="line"></div>


                        <div class="form-group">
                            <div class="col-sm-offset-2 col-sm-10">
                                <button type="button" class="btn btn-primary btn-w j-btnSave"><span class="glyphicon glyphicon-ok"></span> 保存修改</button>
                            </div>
                        </div>
                    </form>
                </div>

            </div>
        </div>
    </div>
</div>


<!-- S 底部 -->
<nav class="m-footer">
    <div class="g-container">
        <p class="info"><span>Copyright © 2014-2016 <a class="navbar-link" href="javascript:;">kaistart.com</a></span><span>渝ICP备14039480号-1</span><span>京公网安备 33011002010123</span></p>
        <p class="link">
            <a class="navbar-link" href="javascript:;">关于</a>|
            <a class="navbar-link" href="javascript:;">我们是谁</a>|
            <a class="navbar-link" href="javascript:;">帮助</a>|
            <a class="navbar-link" href="javascript:;">用户协议</a>|
            <a class="navbar-link" href="javascript:;">信任与安全</a>

            <a class="fa fa-weixin" href="javascript:;"></a>
            <a class="fa fa-weibo" href="javascript:;"></a>
        </p>
    </div>
</nav>
<!-- E 底部 -->



<!-- Large modal -->
<div class="modal fade j-txpopBox" role="dialog" aria-labelledby="gridSystemModalLabel">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" id="gridSystemModalLabel">上传头像</h4>
            </div>
            <div class="modal-body text-center">

                <form id="f-form-crop" action="crop.php" method="post" onsubmit="return checkCoords();">
                    <input type="hidden" id="x" name="x" />
                    <input type="hidden" id="y" name="y" />
                    <input type="hidden" id="w" name="w" />
                    <input type="hidden" id="h" name="h" />
                <!--<input type="submit" value="Crop Image" class="btn btn-large btn-inverse" />-->
                </form>
                <script>
                    function checkCoords(){
                        if (parseInt($('#w').val())) return true;
//                        alert('Please select a crop region then press submit.');
                        return false;
                    }
                </script>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
                <button type="button" class="btn btn-primary j-btn-saveCrop">保存图片</button>
            </div>
        </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
</div><!-- /.modal -->

<!-- jquery -->
<script src="libs/jquery-2.2.2/jquery.min.js"></script>

<!-- bootsrap -->
<script src="bootstrap-3.3.5/js/bootstrap.min.js"></script>

<!-- plugins -->
<link rel="stylesheet" href="plugins/jquery-validationEngine/css/validationEngine.jquery.css">
<script src="plugins/jquery-validationEngine/js/jquery.validationEngine-zh_CN.js"></script>
<script src="plugins/jquery-validationEngine/js/jquery.validationEngine.min.js"></script>

<link rel="stylesheet" href="plugins/jquery-upload/Huploadify.css"/>
<script src="plugins/jquery-upload/jquery.Huploadify.js"></script>

<script src="plugins/jquery-city/jquery.cityselect.js"></script>

<link rel="stylesheet" href="plugins/jquery-jcrop/css/jquery.Jcrop.min.css"/>
<script src="plugins/jquery-jcrop/js/jquery.Jcrop.min.js"></script>

<script src="plugins/jquery-prevImg/jquery-prevImg.js"></script>

<!-- linkcloud -->
<script src="js/main.js"></script>

<!-- your js -->
<script>
    $(function() {
        // 个人设置-基本资料
        (function () {
            var $form = $('#f-form-userSetting-base');


            //================= 修改头像 ==================
            var $btntx = $form.find('.j-uploadtx');
            var $btnSave = $('.j-btn-saveCrop');
            var $formCrop = $('#f-form-crop');
            var api;

            $btntx.change(function (ev) {

                //app.ui.preImg('j-fileImg', 'j-prevImgBox');
                $("#j-fileImg").uploadPreview({ Img: "j-prevImgBox", Width: 120, Height: 120 });
                //preImg('j-fileImg', 'j-prevImg');

                //var $content = $modal.find('.modal-content img');
                //
                //console.log(ev.target.files[0]);
                ////$content.attr('src',);
                ////var f =  $(this).get(0).files[0];
                ////var src = window.URL.createObjectURL(f);

                ////$(this).val('');
            });

            function preImg(sourceId, targetId) {
                var url = getFileUrl(sourceId);

                if (url) {
                    var $modal = $('.j-txpopBox');

                    //var imgPre = document.getElementById(targetId);
                    //imgPre.src = url;

                    $('#j-prevImg').Jcrop({
                        aspectRatio: 1,
                        boxHeight: 500,
                        onSelect: updateCoords
                    }, function () {
                        api = this;
                    });

                    api.setImage(url);

                    $modal.modal();
                }

            }

            $('.j-txpopBox').on('hidden.bs.modal', function (e) {
                api.destroy();
                $btntx.val('');
            });

            $btnSave.click(function () {
                //console.log(api.tellSelect());
                if (api.tellSelect().w > 0) {
                    $.post('crop.php', {}, function (text) {
                        alert(text);
                    });
                }
            });

            function updateCoords(c) {
                $('#x').val(Math.floor(c.x));
                $('#y').val(Math.floor(c.y));
                $('#w').val(Math.floor(c.w));
                $('#h').val(Math.floor(c.h));
            }


            function getFullPath(obj) {
                // 得到图片的完整路径
                if (obj) {
                    // ie
                    if (window.navigator.userAgent.indexOf("MSIE") >= 1) {
                        obj.select();
                        return document.selection.createRange().text;
                    }
                    // firefox
                    else if (window.navigator.userAgent.indexOf("Firefox") >= 1) {
                        if (obj.files) {
                            return obj.files.item(0).getAsDataURL();
                        }
                        return obj.value;
                    }
                    return obj.value;
                }
            }

            //function getFileUrl(sourceId) {
            //    if (!document.getElementById(sourceId).value.match(/.jpg|.gif|.png|.bmp/i)) {
            //        alert('图片格式无效！');
            //        return false;
            //    }
            //    var url;
            //    if (navigator.userAgent.indexOf("MSIE") >= 1) { // IE
            //        url = document.getElementById(sourceId).value;
            //    } else if (navigator.userAgent.indexOf("Firefox") > 0) { // Firefox
            //        url = window.URL.createObjectURL(document.getElementById(sourceId).files.item(0));
            //    } else if (navigator.userAgent.indexOf("Chrome") > 0) { // Chrome
            //        url = window.URL.createObjectURL(document.getElementById(sourceId).files.item(0));
            //    }
            //    return url;
            //}

            //================= / 修改头像 ==================


            // 添加标签
            var $tagBox = $form.find('.j-tagBox');
            var $tagBtn = $form.find('.j-addTag');
            var $tagIpt = $form.find('.j-tagIpt');
            var tagLen = 5;
            var curLen = 0;

            $tagBtn.click(function () {
                curLen = $tagBox.children().length;
                var _str = $.trim($tagIpt.val());

                if (_str.length > 0) {
                    if (curLen < tagLen) {
                        var $label = $('<span class="label label-info">' + _str + '</span> ');
                        $tagBox.show().append($label);
                        $tagIpt.val('');
                    }
                }
            });


            // 添加工作地
            var $placeBox = $form.find('.j-placeBox');
            var $placeBtn = $form.find('.j-addPlace');
            var $placeIpt = $form.find('.j-placeIpt');

            $placeBtn.click(function () {
                var _str = $.trim($placeIpt.val());
                if (_str.length > 0) {
                    var $li = $('<li>' + _str + '</li>');
                    $placeBox.show().append($li);
                    $placeIpt.val('');
                }
            });


            // 职业经历
            var $liveBox = $form.find('.j-liveBox');
            var $liveBtn = $form.find('.j-addLive');
            var curLiveLen = 0;

            $liveBtn.click(function () {
                curLiveLen++;

                var _str = $('<li class="f-mb10">' +
                        '<input name="lives[' + curLiveLen + '][company]" type="text" class="form-control" placeholder="公司或组织名称">' +
                        '<input name="lives[' + curLiveLen + '][job]" type="text" class="form-control" placeholder="你的职位（选填）">' +
                        '<a href="javascript:;"><span class="glyphicon glyphicon-remove"></span></a>' +
                        '</li>');

                $liveBox.append(_str);

            });

            $liveBox.click(function (e) {
                var $target = $(e.target);
                if (e.target.nodeName.toLowerCase() == 'span') {
                    $target.parents('li').remove();
                }
            });


            // 教育经历
            var $teachBox = $form.find('.j-teachBox');
            var $teachBtn = $form.find('.j-addTeach');
            var curTeachLen = 0;

            $teachBtn.click(function () {
                curTeachLen++;

                var _str = $('<li class="f-mb10">' +
                        '<input name="teach[' + curTeachLen + '][school]" type="text" class="form-control" placeholder="学校或教育机构名称">' +
                        '<input name="teach[' + curTeachLen + '][specialty]" type="text" class="form-control" placeholder="专业方向（选填）">' +
                        '<a href="javascript:;"><span class="glyphicon glyphicon-remove"></span></a>' +
                        '</li>');

                $teachBox.append(_str);

            });

            $teachBox.click(function (e) {
                var $target = $(e.target);
                if (e.target.nodeName.toLowerCase() == 'span') {
                    $target.parents('li').remove();
                }
            });


            function getAllTags() {
                var sTags = '';
                $tagBox.children().each(function (index, elem) {
                    sTags += $(this).html() + ',';
                });

                if (sTags.length > 0) {
                    sTags = sTags.substring(0, sTags.length - 1);
                }
                return sTags;
            }


            var $btnSave = $('.j-btnSave');

            $btnSave.click(function () {
                var seri = $form.serialize();
                //console.log(getAllTags());
                console.log(seri);

                //$.post(
                //    // 接收数据的PHP页面
                //    url : 'action.php',
                //    // 传给PHP的数据，多个参数用&连接或者使用json格式数据：{a:'value1',b:'value2'}
                //    data : "a=value1&b=value2",
                //    function(msg){
                //        // 这里是请求发送成功后的回调函数。
                //        // msg是返回的数据，数据类型在type参数里定义！
                //    },
                //    // 默认返回字符串，设置值等于json则返回json数据
                //    type:'json',
                //)

                //$form.submit();
            });

        })();
    });
</script>
</body>
</html>